{% extends "base.html" %}

{% block title %}Gestionar Usuarios{% endblock %}

{% block content %}
<h2>Gestionar Usuarios Postulantes de IESTPO</h2>

<div class="card" style="background: #fff; border: 1px solid #ddd; border-radius: 4px; padding: 20px; margin: 20px 0;">
    <div class="table-container">
        <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
            <thead>
                <tr style="background: #f2f2f2;">
                    <th style="padding: 8px; border: 1px solid #ccc;">ID</th>
                    <th style="padding: 8px; border: 1px solid #ccc;">Nombres</th>
                    <th style="padding: 8px; border: 1px solid #ccc;">Apellidos</th>
                    <th style="padding: 8px; border: 1px solid #ccc;">DNI</th>
                    <th style="padding: 8px; border: 1px solid #ccc;">Email</th>
                    <th style="padding: 8px; border: 1px solid #ccc;">Estado</th>
                    <th style="padding: 8px; border: 1px solid #ccc;">Fecha Postulaci√≥n</th>
                    <th style="padding: 8px; border: 1px solid #ccc;">Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for postulante in postulantes %}
                <tr>
                    <td style="padding: 8px; border: 1px solid #ccc;">{{ postulante.id }}</td>
                    <td style="padding: 8px; border: 1px solid #ccc;">{{ postulante.nombres }}</td>
                    <td style="padding: 8px; border: 1px solid #ccc;">{{ postulante.apellidos }}</td>
                    <td style="padding: 8px; border: 1px solid #ccc;">{{ postulante.dni }}</td>
                    <td style="padding: 8px; border: 1px solid #ccc;">{{ postulante.usuario.email }}</td>
                    <td style="padding: 8px; border: 1px solid #ccc;">
                        <span style="
                            padding: 3px 8px;
                            border-radius: 3px;
                            font-size: 0.85em;
                            {% if postulante.estado == 'aprobado' %}background: #d4edda; color: #155724;
                            {% elif postulante.estado == 'rechazado' %}background: #f8d7da; color: #721c24;
                            {% else %}background: #fff3cd; color: #856404;{% endif %}
                        ">
                            {{ postulante.estado|title }}
                        </span>
                    </td>
                    <td style="padding: 8px; border: 1px solid #ccc;">{{ postulante.fecha_registro.strftime('%d/%m/%Y') }}</td>
                    <td style="padding: 8px; border: 1px solid #ccc;">
                        <form method="POST" action="{{ url_for('cambiar_estado_postulante', postulante_id=postulante.id) }}" style="display: inline;">
                            <select name="estado" onchange="this.form.submit()" style="padding: 4px; border: 1px solid #ccc; border-radius: 3px;">
                                <option value="pendiente" {% if postulante.estado == 'pendiente' %}selected{% endif %}>Pendiente</option>
                                <option value="aprobado" {% if postulante.estado == 'aprobado' %}selected{% endif %}>Aprobado</option>
                                <option value="rechazado" {% if postulante.estado == 'rechazado' %}selected{% endif %}>Rechazado</option>
                            </select>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<a href="{{ url_for('admin_dashboard') }}" style="
    display: inline-block;
    background: #6c757d;
    color: white;
    padding: 8px 16px;
    text-decoration: none;
    border-radius: 4px;
    margin-top: 20px;
">
    Volver al Panel
</a>
{% endblock %}